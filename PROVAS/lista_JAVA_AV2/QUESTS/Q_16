import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

class Biblioteca {
    private HashMap<String, String> catalogo = new HashMap<>();
    
    public boolean adicionarLivro(String isbn, String titulo) {
        if (catalogo.containsKey(isbn)) { // ğŸ—ºï¸ Verifica se chave jÃ¡ existe
            System.out.println("âŒ ISBN '" + isbn + "' jÃ¡ estÃ¡ cadastrado para o livro: " + catalogo.get(isbn));
            return false;
        }
        
        catalogo.put(isbn, titulo); // ğŸ—ºï¸ Adiciona par (chave, valor)
        System.out.println("âœ… Livro adicionado com sucesso!");
        return true;
    }
    
    public boolean removerLivro(String isbn) {
        if (!catalogo.containsKey(isbn)) { // ğŸ—ºï¸ Verifica existÃªncia
            System.out.println("âŒ ISBN '" + isbn + "' nÃ£o encontrado!");
            return false;
        }
        
        String tituloRemovido = catalogo.remove(isbn); // ğŸ—ºï¸ Remove e retorna valor
        System.out.println("ğŸ—‘ï¸ Livro removido: " + tituloRemovido);
        return true;
    }
    
    public void buscarLivroPorISBN(String isbn) {
        if (catalogo.containsKey(isbn)) { // ğŸ—ºï¸ Verifica se chave existe
            String titulo = catalogo.get(isbn); // ğŸ—ºï¸ Busca valor pela chave
            System.out.println("\nğŸ” Livro encontrado:");
            System.out.println("   ISBN: " + isbn);
            System.out.println("   TÃ­tulo: " + titulo);
        } else {
            System.out.println("âŒ Nenhum livro com ISBN: " + isbn);
        }
    }
    
    public void buscarLivroPorTitulo(String tituloBusca) {
        System.out.println("\nğŸ” Buscando por: '" + tituloBusca + "'");
        boolean encontrado = false;
        
        for (Map.Entry<String, String> entry : catalogo.entrySet()) { // ğŸ—ºï¸ Itera todos os pares
            String titulo = entry.getValue(); // ğŸ—ºï¸ Pega valor
            String isbn = entry.getKey(); // ğŸ—ºï¸ Pega chave
            
            if (titulo.toLowerCase().contains(tituloBusca.toLowerCase())) {
                if (!encontrado) {
                    System.out.println("ğŸ“š Livros encontrados:");
                    encontrado = true;
                }
                System.out.println("   ISBN: " + isbn + " | TÃ­tulo: " + titulo);
            }
        }
        
        if (!encontrado) {
            System.out.println("âŒ Nenhum livro encontrado");
        }
    }
    
    public void exibirTodosLivros() {
        if (catalogo.isEmpty()) { // ğŸ—ºï¸ Verifica se mapa estÃ¡ vazio
            System.out.println("ğŸ“­ CatÃ¡logo vazio!");
            return;
        }
        
        System.out.println("\n=== ğŸ“š CATÃLOGO COMPLETO ===");
        System.out.println("Total de livros: " + catalogo.size()); // ğŸ—ºï¸ Tamanho do mapa
        
        int contador = 1;
        for (Map.Entry<String, String> entry : catalogo.entrySet()) { // ğŸ—ºï¸ Itera pares
            System.out.printf("%d. ISBN: %s | TÃ­tulo: %s\n", 
                contador, entry.getKey(), entry.getValue()); // ğŸ—ºï¸ getKey() e getValue()
            contador++;
        }
        System.out.println("================================\n");
    }
    
    public boolean tituloExiste(String titulo) {
        for (String tituloCadastrado : catalogo.values()) { // ğŸ—ºï¸ Itera apenas valores
            if (tituloCadastrado.equalsIgnoreCase(titulo)) {
                return true;
            }
        }
        return false;
    }
    
    public void verificarTituloExistente(String titulo) {
        boolean existe = false;
        
        System.out.println("\nğŸ” Verificando tÃ­tulo: '" + titulo + "'");
        
        for (Map.Entry<String, String> entry : catalogo.entrySet()) { // ğŸ—ºï¸ Itera pares
            if (entry.getValue().equalsIgnoreCase(titulo)) { // ğŸ—ºï¸ Compara valor
                if (!existe) {
                    System.out.println("âš ï¸ TÃ­tulo jÃ¡ existe:");
                    existe = true;
                }
                System.out.println("   ISBN: " + entry.getKey() + " | TÃ­tulo: " + entry.getValue());
            }
        }
        
        if (!existe) {
            System.out.println("âœ… TÃ­tulo disponÃ­vel!");
        }
    }
    
    public int getQuantidadeLivros() {
        return catalogo.size(); // ğŸ—ºï¸ Retorna quantidade de pares
    }
    
    public boolean isbnExiste(String isbn) {
        return catalogo.containsKey(isbn); // ğŸ—ºï¸ Verifica existÃªncia da chave
    }
    
    // MÃ©todo extra: mostrar todos os ISBNs
    public void mostrarTodosISBNs() {
        System.out.println("\n=== ğŸ”‘ TODOS OS ISBNs ===");
        for (String isbn : catalogo.keySet()) { // ğŸ—ºï¸ Itera apenas chaves
            System.out.println("ISBN: " + isbn);
        }
    }
    
    // MÃ©todo extra: atualizar tÃ­tulo mantendo mesmo ISBN
    public boolean atualizarTitulo(String isbn, String novoTitulo) {
        if (catalogo.containsKey(isbn)) {
            String tituloAntigo = catalogo.put(isbn, novoTitulo); // ğŸ—ºï¸ put() atualiza e retorna valor antigo
            System.out.println("ğŸ“ TÃ­tulo atualizado:");
            System.out.println("   De: " + tituloAntigo);
            System.out.println("   Para: " + novoTitulo);
            return true;
        }
        return false;
    }
    
    public static void limparTela() {
        try {
            if (System.getProperty("os.name").contains("Windows")) {
                new ProcessBuilder("cmd", "/c", "cls").inheritIO().start().waitFor();
            } else {
                System.out.print("\033[H\033[2J");
                System.out.flush();
            }
        } catch (Exception e) {
            for (int i = 0; i < 20; i++) {
                System.out.println();
            }
        }
    }
}

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        Biblioteca biblioteca = new Biblioteca();
        
        adicionarLivrosExemplo(biblioteca);
        
        while (true) {
            exibirMenuPrincipal();
            System.out.print("OpÃ§Ã£o: ");
            
            int opcao = scanner.nextInt();
            scanner.nextLine();
            
            switch (opcao) {
                case 1:
                    adicionarLivroInterface(scanner, biblioteca);
                    break;
                case 2:
                    removerLivroInterface(scanner, biblioteca);
                    break;
                case 3:
                    buscarLivroInterface(scanner, biblioteca);
                    break;
                case 4:
                    Biblioteca.limparTela();
                    biblioteca.exibirTodosLivros();
                    pausar(scanner);
                    break;
                case 5:
                    verificarTituloInterface(scanner, biblioteca);
                    break;
                case 6:
                    demonstrarFuncionalidadesMap(biblioteca);
                    pausar(scanner);
                    break;
                case 7:
                    System.out.println("ğŸ‘‹ Saindo...");
                    scanner.close();
                    return;
                default:
                    System.out.println("âŒ OpÃ§Ã£o invÃ¡lida!");
                    pausar(scanner);
            }
        }
    }
    
    public static void demonstrarFuncionalidadesMap(Biblioteca biblioteca) {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ—ºï¸ DEMONSTRAÃ‡ÃƒO FUNÃ‡Ã•ES MAP ===");
        
        System.out.println("\n1. ğŸ“Š catalogo.size(): " + biblioteca.getQuantidadeLivros());
        
        System.out.println("\n2. ğŸ”‘ catalogo.keySet() - Todos ISBNs:");
        for (String isbn : biblioteca.catalogo.keySet()) { // ğŸ—ºï¸ Itera chaves
            System.out.println("   " + isbn);
        }
        
        System.out.println("\n3. ğŸ“– catalogo.values() - Todos tÃ­tulos:");
        for (String titulo : biblioteca.catalogo.values()) { // ğŸ—ºï¸ Itera valores
            System.out.println("   " + titulo);
        }
        
        System.out.println("\n4. ğŸ” catalogo.get() - Buscar ISBN especÃ­fico:");
        String isbnTeste = "978-85-359-0277-5";
        System.out.println("   " + isbnTeste + " â†’ " + biblioteca.catalogo.get(isbnTeste));
        
        System.out.println("\n5. âŒ catalogo.remove() - Remover um livro:");
        biblioteca.removerLivro("978-85-7232-227-8");
        System.out.println("   Novo tamanho: " + biblioteca.getQuantidadeLivros());
    }
    
    public static void exibirMenuPrincipal() {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ“š SISTEMA BIBLIOTECA ===");
        System.out.println("1 - Adicionar livro");
        System.out.println("2 - Remover livro");
        System.out.println("3 - Buscar livro");
        System.out.println("4 - Exibir catÃ¡logo completo");
        System.out.println("5 - Verificar tÃ­tulo existente");
        System.out.println("6 - DemonstraÃ§Ã£o funÃ§Ãµes Map");
        System.out.println("7 - Sair");
        System.out.println("==============================");
    }
    
    public static void adicionarLivroInterface(Scanner scanner, Biblioteca biblioteca) {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ“– ADICIONAR LIVRO ===");
        
        System.out.print("ISBN: ");
        String isbn = scanner.nextLine().trim();
        
        System.out.print("TÃ­tulo: ");
        String titulo = scanner.nextLine().trim();
        
        if (!isbn.isEmpty() && !titulo.isEmpty()) {
            biblioteca.adicionarLivro(isbn, titulo);
        } else {
            System.out.println("âŒ ISBN e TÃ­tulo nÃ£o podem ser vazios!");
        }
        
        pausar(scanner);
    }
    
    public static void removerLivroInterface(Scanner scanner, Biblioteca biblioteca) {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ—‘ï¸ REMOVER LIVRO ===");
        
        System.out.print("ISBN do livro a remover: ");
        String isbn = scanner.nextLine().trim();
        
        if (!isbn.isEmpty()) {
            biblioteca.removerLivro(isbn);
        } else {
            System.out.println("âŒ ISBN nÃ£o pode ser vazio!");
        }
        
        pausar(scanner);
    }
    
    public static void buscarLivroInterface(Scanner scanner, Biblioteca biblioteca) {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ” BUSCAR LIVRO ===");
        System.out.println("1 - Buscar por ISBN");
        System.out.println("2 - Buscar por TÃ­tulo");
        System.out.print("OpÃ§Ã£o: ");
        
        int opcao = scanner.nextInt();
        scanner.nextLine();
        
        switch (opcao) {
            case 1:
                System.out.print("Digite o ISBN: ");
                String isbn = scanner.nextLine().trim();
                biblioteca.buscarLivroPorISBN(isbn);
                break;
            case 2:
                System.out.print("Digite o tÃ­tulo: ");
                String titulo = scanner.nextLine().trim();
                biblioteca.buscarLivroPorTitulo(titulo);
                break;
            default:
                System.out.println("âŒ OpÃ§Ã£o invÃ¡lida!");
        }
        
        pausar(scanner);
    }
    
    public static void verificarTituloInterface(Scanner scanner, Biblioteca biblioteca) {
        Biblioteca.limparTela();
        System.out.println("=== ğŸ” VERIFICAR TÃTULO ===");
        
        System.out.print("Digite o tÃ­tulo a verificar: ");
        String titulo = scanner.nextLine().trim();
        
        if (!titulo.isEmpty()) {
            biblioteca.verificarTituloExistente(titulo);
        } else {
            System.out.println("âŒ TÃ­tulo nÃ£o pode ser vazio!");
        }
        
        pausar(scanner);
    }
    
    public static void adicionarLivrosExemplo(Biblioteca biblioteca) {
        biblioteca.adicionarLivro("978-85-359-0277-5", "Dom Casmurro");
        biblioteca.adicionarLivro("978-85-7232-227-8", "O CortiÃ§o");
        biblioteca.adicionarLivro("978-85-325-1114-7", "1984");
        biblioteca.adicionarLivro("978-85-359-0276-8", "MemÃ³rias PÃ³stumas de BrÃ¡s Cubas");
    }
    
    public static void pausar(Scanner scanner) {
        System.out.println("\nâ Pressione Enter para continuar...");
        scanner.nextLine();
    }
}
