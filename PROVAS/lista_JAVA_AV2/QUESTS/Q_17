import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

class UrnaEletronica {
    private HashMap<String, String> votos = new HashMap<>(); // ğŸ—ºï¸ CPF â†’ Candidato
    private HashMap<String, Integer> contagemVotos = new HashMap<>(); // ğŸ—ºï¸ Candidato â†’ Total de votos
    
    // a) MÃ©todo para registrar votos sem duplicaÃ§Ã£o
    public boolean registrarVoto(String cpf, String candidato) {
        if (votos.containsKey(cpf)) { // ğŸ—ºï¸ Verifica se CPF jÃ¡ votou
            System.out.println("âŒ CPF " + cpf + " jÃ¡ votou! Voto nÃ£o computado.");
            return false;
        }
        
        votos.put(cpf, candidato); // ğŸ—ºï¸ Registra voto (CPF â†’ Candidato)
        
        // Atualiza contagem de votos do candidato
        contagemVotos.put(candidato, contagemVotos.getOrDefault(candidato, 0) + 1); // ğŸ—ºï¸ getOrDefault evita NullPointerException
        
        System.out.println("âœ… Voto registrado com sucesso!");
        System.out.println("   CPF: " + cpf);
        System.out.println("   Candidato: " + candidato);
        return true;
    }
    
    // b) MÃ©todo que exiba todos os votos
    public void exibirTodosVotos() {
        if (votos.isEmpty()) { // ğŸ—ºï¸ Verifica se hÃ¡ votos
            System.out.println("ğŸ“­ Nenhum voto registrado ainda.");
            return;
        }
        
        System.out.println("\n=== ğŸ—³ï¸ TODOS OS VOTOS REGISTRADOS ===");
        System.out.println("Total de eleitores que votaram: " + votos.size()); // ğŸ—ºï¸ Quantidade de votos
        System.out.printf("%-15s | %-20s\n", "CPF", "CANDIDATO");
        System.out.println("----------------|----------------------");
        
        for (Map.Entry<String, String> entry : votos.entrySet()) { // ğŸ—ºï¸ Itera todos os pares
            System.out.printf("%-15s | %-20s\n", entry.getKey(), entry.getValue()); // ğŸ—ºï¸ getKey() e getValue()
        }
        System.out.println("======================================\n");
    }
    
    // c) MÃ©todo que calcule o total de votos por candidato
    public void exibirResultadoParcial() {
        if (contagemVotos.isEmpty()) { // ğŸ—ºï¸ Verifica se hÃ¡ votos
            System.out.println("ğŸ“­ Nenhum voto computado ainda.");
            return;
        }
        
        System.out.println("\n=== ğŸ“Š RESULTADO PARCIAL DA ELEIÃ‡ÃƒO ===");
        System.out.printf("%-20s | %-10s\n", "CANDIDATO", "VOTOS");
        System.out.println("---------------------|------------");
        
        for (Map.Entry<String, Integer> entry : contagemVotos.entrySet()) { // ğŸ—ºï¸ Itera contagem
            System.out.printf("%-20s | %-10d\n", entry.getKey(), entry.getValue());
        }
        System.out.println("Total de votantes: " + votos.size());
        System.out.println("====================================\n");
    }
    
    // MÃ©todo para buscar voto por CPF
    public void buscarVotoPorCPF(String cpf) {
        if (votos.containsKey(cpf)) { // ğŸ—ºï¸ Verifica se CPF votou
            String candidato = votos.get(cpf); // ğŸ—ºï¸ Busca candidato votado
            System.out.println("ğŸ” CPF " + cpf + " votou em: " + candidato);
        } else {
            System.out.println("ğŸ” CPF " + cpf + " ainda nÃ£o votou.");
        }
    }
    
    // MÃ©todo para verificar se CPF jÃ¡ votou
    public boolean cpfJaVotou(String cpf) {
        return votos.containsKey(cpf); // ğŸ—ºï¸ VerificaÃ§Ã£o rÃ¡pida O(1)
    }
    
    // MÃ©todo para obter candidato mais votado
    public void exibirCandidatoMaisVotado() {
        if (contagemVotos.isEmpty()) {
            System.out.println("ğŸ“­ Nenhum voto computado.");
            return;
        }
        
        String candidatoMaisVotado = "";
        int maiorVotos = 0;
        
        for (Map.Entry<String, Integer> entry : contagemVotos.entrySet()) { // ğŸ—ºï¸ Itera para encontrar maior
            if (entry.getValue() > maiorVotos) {
                maiorVotos = entry.getValue();
                candidatoMaisVotado = entry.getKey();
            }
        }
        
        System.out.println("\n=== ğŸ† CANDIDATO MAIS VOTADO ===");
        System.out.println("Candidato: " + candidatoMaisVotado);
        System.out.println("Votos: " + maiorVotos);
        System.out.println("==============================\n");
    }
    
    // MÃ©todo para reiniciar a urna (apagar todos os votos)
    public void reiniciarUrna() {
        votos.clear(); // ğŸ—ºï¸ Limpa todos os votos
        contagemVotos.clear(); // ğŸ—ºï¸ Limpa contagem
        System.out.println("ğŸ”„ Urna reiniciada! Todos os votos foram apagados.");
    }
    
    public static void limparTela() {
        try {
            if (System.getProperty("os.name").contains("Windows")) {
                new ProcessBuilder("cmd", "/c", "cls").inheritIO().start().waitFor();
            } else {
                System.out.print("\033[H\033[2J");
                System.out.flush();
            }
        } catch (Exception e) {
            for (int i = 0; i < 20; i++) {
                System.out.println();
            }
        }
    }
}

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        UrnaEletronica urna = new UrnaEletronica();
        
        while (true) {
            exibirMenuPrincipal();
            System.out.print("OpÃ§Ã£o: ");
            
            int opcao = scanner.nextInt();
            scanner.nextLine(); // Limpar buffer
            
            switch (opcao) {
                case 1:
                    registrarVotoInterface(scanner, urna);
                    break;
                    
                case 2:
                    UrnaEletronica.limparTela();
                    urna.exibirTodosVotos();
                    pausar(scanner);
                    break;
                    
                case 3:
                    UrnaEletronica.limparTela();
                    urna.exibirResultadoParcial();
                    pausar(scanner);
                    break;
                    
                case 4:
                    buscarVotoInterface(scanner, urna);
                    break;
                    
                case 5:
                    UrnaEletronica.limparTela();
                    urna.exibirCandidatoMaisVotado();
                    pausar(scanner);
                    break;
                    
                case 6:
                    demonstrarFuncionalidades(urna);
                    pausar(scanner);
                    break;
                    
                case 7:
                    System.out.println("ğŸ”’ Encerrando sistema de votaÃ§Ã£o...");
                    scanner.close();
                    return;
                    
                default:
                    System.out.println("âŒ OpÃ§Ã£o invÃ¡lida!");
                    pausar(scanner);
            }
        }
    }
    
    public static void exibirMenuPrincipal() {
        UrnaEletronica.limparTela();
        System.out.println("=== ğŸ—³ï¸ URNA ELETRÃ”NICA ===");
        System.out.println("1 - Registrar voto");
        System.out.println("2 - Exibir todos os votos");
        System.out.println("3 - Exibir resultado parcial");
        System.out.println("4 - Buscar voto por CPF");
        System.out.println("5 - Candidato mais votado");
        System.out.println("6 - DemonstraÃ§Ã£o do sistema");
        System.out.println("7 - Sair");
        System.out.println("=========================");
    }
    
    public static void registrarVotoInterface(Scanner scanner, UrnaEletronica urna) {
        UrnaEletronica.limparTela();
        System.out.println("=== âœ… REGISTRAR VOTO ===");
        
        System.out.print("Digite o CPF: ");
        String cpf = scanner.nextLine().trim();
        
        // ValidaÃ§Ã£o simples de CPF
        if (cpf.length() != 11 || !cpf.matches("\\d+")) {
            System.out.println("âŒ CPF invÃ¡lido! Deve conter 11 dÃ­gitos.");
            pausar(scanner);
            return;
        }
        
        // Verifica se CPF jÃ¡ votou
        if (urna.cpfJaVotou(cpf)) {
            System.out.println("âŒ Este CPF jÃ¡ votou! Voto nÃ£o permitido.");
            pausar(scanner);
            return;
        }
        
        System.out.println("\nCandidatos disponÃ­veis:");
        System.out.println("1 - JoÃ£o Silva");
        System.out.println("2 - Maria Santos");
        System.out.println("3 - Pedro Oliveira");
        System.out.println("4 - Voto Nulo");
        System.out.println("5 - Voto em Branco");
        System.out.print("Escolha o candidato (1-5): ");
        
        int opcaoCandidato = scanner.nextInt();
        scanner.nextLine(); // Limpar buffer
        
        String candidato;
        switch (opcaoCandidato) {
            case 1: candidato = "JoÃ£o Silva"; break;
            case 2: candidato = "Maria Santos"; break;
            case 3: candidato = "Pedro Oliveira"; break;
            case 4: candidato = "Nulo"; break;
            case 5: candidato = "Branco"; break;
            default: 
                System.out.println("âŒ OpÃ§Ã£o invÃ¡lida! Voto nÃ£o registrado.");
                pausar(scanner);
                return;
        }
        
        urna.registrarVoto(cpf, candidato);
        pausar(scanner);
    }
    
    public static void buscarVotoInterface(Scanner scanner, UrnaEletronica urna) {
        UrnaEletronica.limparTela();
        System.out.println("=== ğŸ” BUSCAR VOTO POR CPF ===");
        
        System.out.print("Digite o CPF: ");
        String cpf = scanner.nextLine().trim();
        
        if (cpf.length() != 11 || !cpf.matches("\\d+")) {
            System.out.println("âŒ CPF invÃ¡lido! Deve conter 11 dÃ­gitos.");
        } else {
            urna.buscarVotoPorCPF(cpf);
        }
        
        pausar(scanner);
    }
    
    public static void demonstrarFuncionalidades(UrnaEletronica urna) {
        UrnaEletronica.limparTela();
        System.out.println("=== ğŸ§ª DEMONSTRAÃ‡ÃƒO DO SISTEMA ===");
        
        System.out.println("\n1. Registrando votos...");
        urna.registrarVoto("12345678901", "JoÃ£o Silva");
        urna.registrarVoto("23456789012", "Maria Santos");
        urna.registrarVoto("34567890123", "JoÃ£o Silva");
        urna.registrarVoto("45678901234", "Pedro Oliveira");
        
        System.out.println("\n2. Tentativa de duplicaÃ§Ã£o...");
        urna.registrarVoto("12345678901", "Maria Santos"); // âŒ Deve falhar
        
        System.out.println("\n3. Exibindo todos os votos:");
        urna.exibirTodosVotos();
        
        System.out.println("4. Resultado parcial:");
        urna.exibirResultadoParcial();
        
        System.out.println("5. Candidato mais votado:");
        urna.exibirCandidatoMaisVotado();
        
        System.out.println("6. Buscando votos especÃ­ficos:");
        urna.buscarVotoPorCPF("12345678901");
        urna.buscarVotoPorCPF("99999999999"); // âŒ NÃ£o existe
    }
    
    public static void pausar(Scanner scanner) {
        System.out.println("\nâ Pressione Enter para continuar...");
        scanner.nextLine();
    }
}
